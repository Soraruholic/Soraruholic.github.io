---
title: 2.2 变量
description: 阅读笔记，摘自《C++ Primer 5th Edition》 
slug: cpp-11-primer-2-2
date: 2023-12-19 00:00:00+0000
image: 1.png
categories:
    - C Plus Plus
tags:
    - C++
    - C++ Primer
    - C++11
weight: 1       # You can add weight to some posts to override the default sorting (date descending)
---

## 变量

### 变量定义

+ 基本形式：**类型说明符** + [**变量名**+**初始化**(可选)] (一个或者多个，彼此之间用**逗号相隔**)。

> CPP Primer此处对于变量定义的语法比较模棱两可，并未考虑复杂的情形，详细的变量声明的文法可见C++11的官方标准。

#### 初始值

+ **初始化**：对象在创建的同时获得了特定的值(初始值)。
+ 可以用任意复杂的**表达式**作为初始值。
+ 可以**迭代初始化**：

```c++
double price = 1.14, discount = 514. * price;
```

+ **初始化不是赋值**，后者需要先将对象的当前值擦除，而后用新值替代。

#### 列表初始化

+ 多种初始化形式:

```c++
int x = 0;
int x(0);

// 列表初始化
int x = {0};
int x{0}; 
```

+ 使用**列表初始化**时，如果初始值存在**丢失信息**的风险，则编译器将报错：

```c++
long double pi = 3.1415926536;
int a{pi}, b = {pi};           // 编译报错(也可能是Warning)，存在精度损失
int a(pi), b = pi;             // 编译通过
```

#### 默认初始化

+ **内置类型**若未被**显式初始化**，
  + 若其定义在**函数体内部**，该变量不被初始化，其值是**未定义**的；
  + 否则，将被**初始化为0**。
+ **每个类**各自决定初始化对象的方式。

### 变量声明与定义的关系

+ **分离式编译**：将程序分割为若干个文件，使得每个文件可被独立编译。
+ 为了支持分离式编译，C++将变量的**声明和定义区分**，
  + **声明**使得变量为程序所知，每个文件使用变量前必须**包含对其的声明**；
  + **定义**负责创建与变量相关的实体。
+ 若想在文件中声明一个变量，而该变量在其他文件中定义，可以在声明时加入关键字`extern`，并且不进行显式初始化：

```c++
extern long double pi;
```

+ 如果使用`extern`的同时对变量进行定义(初始化)，那么`extern`关键字将失效，或者直接报错(对于同一变量的重复定义)。
+ 变量**只能被定义一次**，却可以**多次被声明**。

### 标识符

+ 标识符由**字符**、**数字**和**下划线**，并且数字不能作为开头。
+ 标识符没有长度限制，但是对**大小写敏感**。

#### 变量命名规范

+ 基本规范此处不做详述，选取最合适的现行规范使用即可。
+ 用户自定义标识符**不连续出现两个下划线**。
+ 不以下划线紧连大写字母开头。
+ 定义在函数体外的标识符不以下划线开头。

### 名字的作用域

+ **变量的有效区域始于其声明语句，终结于声明语句所在的作用域末端。**
+ 大多是作用域**以花括号分隔**。
+ **全局作用域**：定义在函数体之外，一旦声明之后，全局作用域内的变量在整个程序范围内都可用。
+ **块作用域**：仅在声明语句之后，且在声明语句的作用域内可用。

#### 嵌套的作用域

+ **外层作用域**可以包含**内层作用域。**

